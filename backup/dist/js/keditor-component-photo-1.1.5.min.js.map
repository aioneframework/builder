{"version":3,"sources":["keditor-component-photo-1.1.5.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","img","find","css","settingEnabled","settingTitle","initSettingForm","form","self","this","options","append","photoEdit","fileInput","next","on","e","preventDefault","trigger","file","files","test","type","getSettingComponent","attr","URL","createObjectURL","width","height","load","showSettingPanel","alert","inputAlign","panel","value","inputResponsive","checked","cbbStyle","val","removeClass","addClass","inputWidth","inputHeight","newWidth","newHeight","Math","round","ratio","showSettingForm","algin","hasClass","prop","jQuery"],"mappings":"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","file":"keditor-component-photo-1.1.5.min.js","sourcesContent":["(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n\n    KEditor.components['photo'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"photo\" component', component);\n\n            var componentContent = component.children('.keditor-component-content');\n            var img = componentContent.find('img');\n\n            img.css('display', 'inline-block');\n        },\n\n        settingEnabled: true,\n\n        settingTitle: 'Photo Settings',\n\n        initSettingForm: function (form, keditor) {\n            flog('initSettingForm \"photo\" component');\n\n            var self = this;\n            var options = keditor.options;\n\n            form.append(\n                '<form class=\"form-horizontal\">' +\n                '   <div class=\"form-group\">' +\n                '       <div class=\"col-sm-12\">' +\n                '           <button type=\"button\" class=\"btn btn-block btn-primary\" id=\"photo-edit\">Change Photo</button>' +\n                '           <input type=\"file\" style=\"display: none\" />' +\n                '       </div>' +\n                '   </div>' +\n                '   <div class=\"form-group\">' +\n                '       <label for=\"photo-align\" class=\"col-sm-12\">Align</label>' +\n                '       <div class=\"col-sm-12\">' +\n                '           <select id=\"photo-align\" class=\"form-control\">' +\n                '               <option value=\"left\">Left</option>' +\n                '               <option value=\"center\">Center</option>' +\n                '               <option value=\"right\">Right</option>' +\n                '           </select>' +\n                '       </div>' +\n                '   </div>' +\n                '   <div class=\"form-group\">' +\n                '       <label for=\"photo-style\" class=\"col-sm-12\">Style</label>' +\n                '       <div class=\"col-sm-12\">' +\n                '           <select id=\"photo-style\" class=\"form-control\">' +\n                '               <option value=\"\">None</option>' +\n                '               <option value=\"img-rounded\">Rounded</option>' +\n                '               <option value=\"img-circle\">Circle</option>' +\n                '               <option value=\"img-thumbnail\">Thumbnail</option>' +\n                '           </select>' +\n                '       </div>' +\n                '   </div>' +\n                '   <div class=\"form-group\">' +\n                '       <label for=\"photo-responsive\" class=\"col-sm-12\">Responsive</label>' +\n                '       <div class=\"col-sm-12\">' +\n                '           <input type=\"checkbox\" id=\"photo-responsive\" />' +\n                '       </div>' +\n                '   </div>' +\n                '   <div class=\"form-group\">' +\n                '       <label for=\"photo-width\" class=\"col-sm-12\">Width</label>' +\n                '       <div class=\"col-sm-12\">' +\n                '           <input type=\"number\" id=\"photo-width\" class=\"form-control\" />' +\n                '       </div>' +\n                '   </div>' +\n                '   <div class=\"form-group\">' +\n                '       <label for=\"photo-height\" class=\"col-sm-12\">Height</label>' +\n                '       <div class=\"col-sm-12\">' +\n                '           <input type=\"number\" id=\"photo-height\" class=\"form-control\" />' +\n                '       </div>' +\n                '   </div>' +\n                '</form>'\n            );\n\n            var photoEdit = form.find('#photo-edit');\n            var fileInput = photoEdit.next();\n            photoEdit.on('click', function (e) {\n                e.preventDefault();\n\n                fileInput.trigger('click');\n            });\n            fileInput.on('change', function () {\n                var file = this.files[0];\n                if (/image/.test(file.type)) {\n                    var img = keditor.getSettingComponent().find('img');\n                    img.attr('src', URL.createObjectURL(file));\n                    img.css({\n                        width: '',\n                        height: ''\n                    });\n                    img.load(function () {\n                        keditor.showSettingPanel(keditor.getSettingComponent(), options);\n                    });\n                } else {\n                    alert('Your selected file is not photo!');\n                }\n            });\n\n            var inputAlign = form.find('#photo-align');\n            inputAlign.on('change', function () {\n                var panel = keditor.getSettingComponent().find('.photo-panel');\n                panel.css('text-align', this.value);\n            });\n\n            var inputResponsive = form.find('#photo-responsive');\n            inputResponsive.on('click', function () {\n                keditor.getSettingComponent().find('img')[this.checked ? 'addClass' : 'removeClass']('img-responsive');\n            });\n\n            var cbbStyle = form.find('#photo-style');\n            cbbStyle.on('change', function () {\n                var img = keditor.getSettingComponent().find('img');\n                var val = this.value;\n\n                img.removeClass('img-rounded img-circle img-thumbnail');\n                if (val) {\n                    img.addClass(val);\n                }\n            });\n\n            var inputWidth = form.find('#photo-width');\n            var inputHeight = form.find('#photo-height');\n            inputWidth.on('change', function () {\n                var img = keditor.getSettingComponent().find('img');\n                var newWidth = +this.value;\n                var newHeight = Math.round(newWidth / self.ratio);\n\n                if (newWidth <= 0) {\n                    newWidth = self.width;\n                    newHeight = self.height;\n                    this.value = newWidth;\n                }\n\n                img.css({\n                    'width': newWidth,\n                    'height': newHeight\n                });\n                inputHeight.val(newHeight);\n            });\n            inputHeight.on('change', function () {\n                var img = keditor.getSettingComponent().find('img');\n                var newHeight = +this.value;\n                var newWidth = Math.round(newHeight * self.ratio);\n\n                if (newHeight <= 0) {\n                    newWidth = self.width;\n                    newHeight = self.height;\n                    this.value = newHeight;\n                }\n\n                img.css({\n                    'height': newHeight,\n                    'width': newWidth\n                });\n                inputWidth.val(newWidth);\n            });\n        },\n\n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"photo\" component', component);\n\n            var self = this;\n            var inputAlign = form.find('#photo-align');\n            var inputResponsive = form.find('#photo-responsive');\n            var inputWidth = form.find('#photo-width');\n            var inputHeight = form.find('#photo-height');\n            var cbbStyle = form.find('#photo-style');\n\n            var panel = component.find('.photo-panel');\n            var img = panel.find('img');\n\n            var algin = panel.css('text-align');\n            if (algin !== 'right' || algin !== 'center') {\n                algin = 'left';\n            }\n\n            if (img.hasClass('img-rounded')) {\n                cbbStyle.val('img-rounded');\n            } else if (img.hasClass('img-circle')) {\n                cbbStyle.val('img-circle');\n            } else if (img.hasClass('img-thumbnail')) {\n                cbbStyle.val('img-thumbnail');\n            } else {\n                cbbStyle.val('');\n            }\n\n            inputAlign.val(algin);\n            inputResponsive.prop('checked', img.hasClass('img-responsive'));\n            inputWidth.val(img.width());\n            inputHeight.val(img.height());\n\n            $('<img />').attr('src', img.attr('src')).load(function() {\n                self.ratio = this.width / this.height;\n                self.width = this.width;\n                self.height = this.height;\n            });\n        }\n    };\n\n})(jQuery);\n"]}